
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Best and Worst States to be a Taxpayer Debunked</title><meta name="generator" content="MATLAB 8.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-03-24"><meta name="DC.source" content="bestWorstStateTax.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Best and Worst States to be a Taxpayer Debunked</h1><!--introduction--><p>When I saw this <a href="https://plus.google.com/109511956491697549112/posts/AWQpUEzimrp">CNBC post on Google+</a>, my &#8220;bogus data analysis&#8221; radar started sending high alerts.</p><p>
<div style="position:relative;width:556px;height:347px">
<iframe
src="http://d2e70e9yced57e.cloudfront.net/common/wallethub/best-worst-states-to-be-a-taxpayer.html"
width="556" height="347" frameBorder="0" scrolling="no"></iframe>
<a
href="http://wallethub.com/edu/best-worst-states-to-be-a-taxpayer/2416/"
style="position:absolute;top:319px;left:465px;">
<img
src="http://d2e70e9yced57e.cloudfront.net/wallethub/images/blog/wh-gcharts-logo_V6185_.png"
width="76" height="13" alt="WalletHub" />
</a>
</div>
</p><p>This is what they did: <a href="http://wallethub.com/edu/best-worst-states-to-be-a-taxpayer/2416/">WalletHub</a> used average tax amount to rank state, adjusted to the cost of living index.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">What&#8217;s wrong with that?</a></li><li><a href="#2">Simple analysis with MATLAB</a></li><li><a href="#3">Import data</a></li><li><a href="#4">Compare ranking before and after</a></li><li><a href="#5">Prepare a map</a></li><li><a href="#6">plot a map</a></li></ul></div><h2>What&#8217;s wrong with that?<a name="1"></a></h2><p>Well, I happen to think that the tax amount is correlated more directly to income, rather than the cost of living. There is nothing noteworthy to see someone pay higher tax if that person also have higher income.</p><p>In order to understand the true picture, you actually need to think in terms of tax to income ratio. So here is my counter analysis.</p><p><img vspace="5" hspace="5" src="map.png" alt=""> </p><p>You can see that Massachusetts, where I live, actually looks pretty good, along with Mid-Atlantic region in my analysis while they were in red in the original map. On the other hand, the color completely flips in the opposite way in some Gulf Coast states in the Souhtb.</p><p>If you believed in the original analysis and moved from Massachusetts to one of those states, then your tax may go down, but that&#8217; probably because your income goes down even more.</p><h2>Simple analysis with MATLAB<a name="2"></a></h2><p>All I had to do was download the median income dataset from Census Bureau website and merge two datasets. It was pretty easy with newly introduced <i>table</i> data type.</p><h2>Import data<a name="3"></a></h2><p>Using MATLAB R2013b</p><p>data sources</p><div><ul><li><a href="http://wallethub.com/edu/best-worst-states-to-be-a-taxpayer/2416/">http://wallethub.com/edu/best-worst-states-to-be-a-taxpayer/2416/</a></li><li><a href="http://www.census.gov/hhes/www/income/data/statemedian/">http://www.census.gov/hhes/www/income/data/statemedian/</a></li></ul></div><pre class="codeinput"><span class="comment">% clear the workspace, close all figures and clear the command window</span>
clearvars; close <span class="string">all</span>; clc

<span class="comment">% load data from files into tables</span>
Tax = readtable(<span class="string">'bestWostStateTax.csv'</span>);
Income = readtable(<span class="string">'medianincome.csv'</span>);

<span class="comment">% Join tables</span>
T = join(Tax(:,2:3),Income);
<span class="comment">% Rename columns</span>
T.Properties.VariableNames = {<span class="string">'State'</span>,<span class="string">'Tax'</span>,<span class="string">'Income'</span>,<span class="string">'SDev'</span>};

<span class="comment">% Compute Tax to Income Ratio</span>
T.TaxToIncome = T.Tax./T.Income;
<span class="comment">% Get the ranking based on TaxToIncome</span>
T2 = sortrows(T,{<span class="string">'TaxToIncome'</span>});
</pre><h2>Compare ranking before and after<a name="4"></a></h2><pre class="codeinput">disp(<span class="string">'By Avg. Tax               By Avg. Tax Rate'</span>)
disp([T.State T2.State])

<span class="comment">% Averages</span>
muTax=mean(T.Tax);
muTaxToIncome= mean(T2.TaxToIncome);

<span class="comment">% Which states are below average</span>
belowAvgTax = T.State(T.Tax &lt; muTax);
belowAvgRate = T2.State(T2.TaxToIncome &lt; muTaxToIncome);

<span class="comment">% Top 20</span>
disp(<span class="string">'Top20'</span>)
disp(<span class="string">'By Avg. Tax        By Avg. Tax Rate'</span>)
disp([belowAvgTax(1:20) belowAvgRate(1:20)])
</pre><pre class="codeoutput">By Avg. Tax               By Avg. Tax Rate
    'Wyoming'                 'Wyoming'             
    'Alaska'                  'Alaska'              
    'Nevada'                  'Washington'          
    'Florida'                 'Nevada'              
    'South Dakota'            'South Dakota'        
    'Washington'              'Florida'             
    'Texas'                   'Colorado'            
    'Delaware'                'Texas'               
    'North Dakota'            'North Dakota'        
    'Colorado'                'Utah'                
    'New Mexico'              'Delaware'            
    'Alabama'                 'Massachusetts'       
    'Arizona'                 'New Hampshire'       
    'Utah'                    'Virginia'            
    'Mississippi'             'Maryland'            
    'Indiana'                 'District of Columbia'
    'Louisiana'               'Rhode Island'        
    'West Virginia'           'Arizona'             
    'Montana'                 'Hawaii'              
    'Oklahoma'                'New Jersey'          
    'Massachusetts'           'Minnesota'           
    'Rhode Island'            'New Mexico'          
    'South Carolina'          'Alabama'             
    'Missouri'                'Indiana'             
    'Tennessee'               'Oklahoma'            
    'Georgia'                 'Connecticut'         
    'Virginia'                'Missouri'            
    'New Hampshire'           'Montana'             
    'Hawaii'                  'West Virginia'       
    'Kentucky'                'Georgia'             
    'Arkansas'                'Kansas'              
    'Ohio'                    'Michigan'            
    'Kansas'                  'Vermont'             
    'Idaho'                   'South Carolina'      
    'North Carolina'          'Pennsylvania'        
    'Michigan'                'Idaho'               
    'District of Columbia'    'Oregon'              
    'Minnesota'               'Iowa'                
    'Pennsylvania'            'California'          
    'Oregon'                  'Louisiana'           
    'Maryland'                'Tennessee'           
    'Maine'                   'Wisconsin'           
    'Iowa'                    'Mississippi'         
    'New Jersey'              'Ohio'                
    'Vermont'                 'Illinois'            
    'Wisconsin'               'Maine'               
    'Illinois'                'Nebraska'            
    'Connecticut'             'Kentucky'            
    'Nebraska'                'North Carolina'      
    'California'              'Arkansas'            
    'New York'                'New York'            

Top20
By Avg. Tax        By Avg. Tax Rate
    'Wyoming'          'Wyoming'             
    'Alaska'           'Alaska'              
    'Nevada'           'Washington'          
    'Florida'          'Nevada'              
    'South Dakota'     'South Dakota'        
    'Washington'       'Florida'             
    'Texas'            'Colorado'            
    'Delaware'         'Texas'               
    'North Dakota'     'North Dakota'        
    'Colorado'         'Utah'                
    'New Mexico'       'Delaware'            
    'Alabama'          'Massachusetts'       
    'Arizona'          'New Hampshire'       
    'Utah'             'Virginia'            
    'Mississippi'      'Maryland'            
    'Indiana'          'District of Columbia'
    'Louisiana'        'Rhode Island'        
    'West Virginia'    'Arizona'             
    'Montana'          'Hawaii'              
    'Oklahoma'         'New Jersey'          

</pre><h2>Prepare a map<a name="5"></a></h2><pre class="codeinput">states = shaperead(<span class="string">'usastatelo'</span>, <span class="string">'UseGeoCoords'</span>, true);
names = {states.Name};
ranking = zeros(length(names),1);
<span class="keyword">for</span> i=1:length(names)
    ranking(i)=find(strcmpi(names(i),T2.State));
<span class="keyword">end</span>
colors = redgreencmap(length(ranking));
stateColors = colors(ranking,:);
indexHawaii = strcmp(<span class="string">'Hawaii'</span>,names);
indexAlaska = strcmp(<span class="string">'Alaska'</span>,names);
indexConus = 1:numel(states);
indexConus(indexHawaii|indexAlaska) = [];
</pre><h2>plot a map<a name="6"></a></h2><pre class="codeinput">figure; ax = usamap(<span class="string">'all'</span>);
set(ax, <span class="string">'Visible'</span>, <span class="string">'off'</span>)
<span class="keyword">for</span> j = 1:length(indexConus)
    geoshow(ax(1), states(indexConus(j)),<span class="string">'FaceColor'</span>,stateColors(indexConus(j),:))
<span class="keyword">end</span>
geoshow(ax(2), states(indexAlaska),<span class="string">'FaceColor'</span>,stateColors(indexAlaska,:))
geoshow(ax(3), states(indexHawaii),<span class="string">'FaceColor'</span>,stateColors(indexHawaii,:))
<span class="keyword">for</span> k = 1:3
    setm(ax(k), <span class="string">'Frame'</span>, <span class="string">'off'</span>, <span class="string">'Grid'</span>, <span class="string">'off'</span>,<span class="keyword">...</span>
      <span class="string">'ParallelLabel'</span>, <span class="string">'off'</span>, <span class="string">'MeridianLabel'</span>, <span class="string">'off'</span>)
<span class="keyword">end</span>
colormap(colors)
colorbar
</pre><img vspace="5" hspace="5" src="bestWorstStateTax_01.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Best and Worst States to be a Taxpayer Debunked
% 
% When I saw this 
% <https://plus.google.com/109511956491697549112/posts/AWQpUEzimrp 
% CNBC post on Google+>, my “bogus data analysis” radar started sending 
% high alerts.
% 
% <html>
% <div style="position:relative;width:556px;height:347px">
% <iframe 
% src="http://d2e70e9yced57e.cloudfront.net/common/wallethub/best-worst-states-to-be-a-taxpayer.html" 
% width="556" height="347" frameBorder="0" scrolling="no"></iframe>
% <a 
% href="http://wallethub.com/edu/best-worst-states-to-be-a-taxpayer/2416/" 
% style="position:absolute;top:319px;left:465px;">
% <img 
% src="http://d2e70e9yced57e.cloudfront.net/wallethub/images/blog/wh-gcharts-logo_V6185_.png" 
% width="76" height="13" alt="WalletHub" />
% </a>
% </div>
% </html>
%
% This is what they did: 
% <http://wallethub.com/edu/best-worst-states-to-be-a-taxpayer/2416/
% WalletHub> used average tax amount to rank state, adjusted to the 
% cost of living index.
%
%%% What’s wrong with that?
% Well, I happen to think that the tax amount is correlated more directly 
% to income, rather than the cost of living. There is nothing noteworthy
% to see someone pay higher tax if that person also have higher income.
% 
% In order to understand the true picture, you actually need to think in 
% terms of tax to income ratio. So here is my counter analysis.
% 
% <<map.png>>
% 
% You can see that Massachusetts, where I live, actually looks pretty good, 
% along with Mid-Atlantic region in my analysis while they were in red in
% the original map. On the other hand, the color completely flips in the 
% opposite way in some Gulf Coast states in the Souhtb. 
% 
% If you believed in the original analysis and moved from Massachusetts to 
% one of those states, then your tax may go down, but that’ probably because 
% your income goes down even more.
%
%%% Simple analysis with MATLAB
% All I had to do was download the median income dataset from Census 
% Bureau website and merge two datasets. It was pretty easy with newly 
% introduced _table_ data type.
%

%% Import data
% Using MATLAB R2013b
% 
% data sources
% 
% * http://wallethub.com/edu/best-worst-states-to-be-a-taxpayer/2416/
% * http://www.census.gov/hhes/www/income/data/statemedian/

% clear the workspace, close all figures and clear the command window
clearvars; close all; clc

% load data from files into tables
Tax = readtable('bestWostStateTax.csv');
Income = readtable('medianincome.csv');

% Join tables
T = join(Tax(:,2:3),Income);
% Rename columns
T.Properties.VariableNames = {'State','Tax','Income','SDev'};

% Compute Tax to Income Ratio
T.TaxToIncome = T.Tax./T.Income;
% Get the ranking based on TaxToIncome
T2 = sortrows(T,{'TaxToIncome'});

%% Compare ranking before and after
disp('By Avg. Tax               By Avg. Tax Rate')
disp([T.State T2.State])

% Averages
muTax=mean(T.Tax);
muTaxToIncome= mean(T2.TaxToIncome);

% Which states are below average
belowAvgTax = T.State(T.Tax < muTax);
belowAvgRate = T2.State(T2.TaxToIncome < muTaxToIncome);

% Top 20
disp('Top20')
disp('By Avg. Tax        By Avg. Tax Rate')
disp([belowAvgTax(1:20) belowAvgRate(1:20)])


%% Prepare a map

states = shaperead('usastatelo', 'UseGeoCoords', true);
names = {states.Name};
ranking = zeros(length(names),1);
for i=1:length(names)
    ranking(i)=find(strcmpi(names(i),T2.State));
end
colors = redgreencmap(length(ranking));
stateColors = colors(ranking,:);
indexHawaii = strcmp('Hawaii',names);
indexAlaska = strcmp('Alaska',names);
indexConus = 1:numel(states);
indexConus(indexHawaii|indexAlaska) = []; 

%% plot a map

figure; ax = usamap('all');
set(ax, 'Visible', 'off')
for j = 1:length(indexConus)
    geoshow(ax(1), states(indexConus(j)),'FaceColor',stateColors(indexConus(j),:))
end
geoshow(ax(2), states(indexAlaska),'FaceColor',stateColors(indexAlaska,:))
geoshow(ax(3), states(indexHawaii),'FaceColor',stateColors(indexHawaii,:))
for k = 1:3
    setm(ax(k), 'Frame', 'off', 'Grid', 'off',...
      'ParallelLabel', 'off', 'MeridianLabel', 'off')
end
colormap(colors)
colorbar
##### SOURCE END #####
--></body></html>